# ✅ Автоматическая проверка настроек

## Быстрая проверка (выполните все шаги):

### Шаг 1: Обновление кода ✅
- [ ] Откройте https://script.google.com
- [ ] Найдите ваш проект
- [ ] Полностью замените весь код на код из `GOOGLE_APPS_SCRIPT_CODE.js`
- [ ] Сохраните (Ctrl+S или Cmd+S)

### Шаг 2: Тест email (КРИТИЧНО!) ✅
- [ ] В редакторе выберите функцию `testEmail` из выпадающего списка
- [ ] Нажмите ▶️ Run
- [ ] Предоставьте ВСЕ разрешения, которые запросит Google
- [ ] Проверьте логи - должно быть `✅ Test email sent successfully!`
- [ ] Проверьте почту `ktv@kaykovmedia.com` - должно прийти тестовое письмо
- [ ] Проверьте папку "Спам" - иногда письма попадают туда

### Шаг 3: Переразвёртывание Web App ✅
- [ ] Нажмите Deploy → Manage deployments
- [ ] Если есть существующий deployment, нажмите ✏️ Edit
- [ ] Нажмите Deploy
- [ ] Убедитесь, что настройки:
  - Execute as: **Me**
  - Who has access: **Anyone**
- [ ] Скопируйте новый URL (если изменился)

### Шаг 4: Проверка URL в коде ✅
- [ ] Откройте `src/lib/googleSheets.ts`
- [ ] Проверьте, что URL совпадает с URL из Apps Script
- [ ] Если не совпадает - обновите

### Шаг 5: Тест формы ✅
- [ ] Откройте ваш сайт
- [ ] Заполните и отправьте форму
- [ ] Откройте консоль браузера (F12)
- [ ] Проверьте логи - должны быть сообщения об отправке

### Шаг 6: Проверка логов Apps Script ✅
- [ ] В Apps Script откройте Executions (⏰)
- [ ] Найдите последнее выполнение `doPost`
- [ ] Откройте его
- [ ] Проверьте логи:
  - Должно быть `=== doPost called ===`
  - Должно быть `✅ Email sent successfully`
  - Не должно быть `❌ ERROR`

### Шаг 7: Проверка Google Sheets ✅
- [ ] Откройте Google Sheet: https://docs.google.com/spreadsheets/d/1OPGRV7LVeiuOxsS5Qs4ZQSlOar5l42uZp3znm7ynWgY/edit
- [ ] Проверьте, что данные сохраняются в таблицу

### Шаг 8: Финальная проверка email ✅
- [ ] Проверьте почту `ktv@kaykovmedia.com`
- [ ] Проверьте папку "Спам"
- [ ] Должно прийти письмо с новым лидом

## Если что-то не работает:

### Email не приходит, но данные сохраняются:
1. Проверьте логи в Executions - какая ошибка?
2. Проверьте, что запустили `testEmail()` и предоставили разрешения
3. Проверьте папку "Спам"
4. Проверьте, правильный ли email адрес

### Данные не сохраняются:
1. Проверьте Sheet ID в коде
2. Проверьте, что у скрипта есть доступ к таблице
3. Проверьте логи в Executions

### Скрипт не получает данные:
1. Проверьте URL в `src/lib/googleSheets.ts`
2. Проверьте, что Web App развёрнут с правильными настройками
3. Используйте тестовую страницу `DETAILED_TEST.html`

## Контакты для диагностики:

После выполнения всех шагов, если проблема остаётся:
1. Сделайте скриншот логов из Executions
2. Сделайте скриншот консоли браузера
3. Укажите, на каком шаге возникла проблема



