# üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –¢–†–ò–ì–ì–ï–†–ê: –ü–æ—á–µ–º—É email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω?

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://script.google.com
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ù–∞–∂–º–∏—Ç–µ ‚è∞ **Triggers** —Å–ª–µ–≤–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ —Ç—Ä–∏–≥–≥–µ—Ä `onSheetEdit`:
   - **Function:** `onSheetEdit`
   - **Event source:** `From spreadsheet`
   - **Event type:** `On edit`
   - **Status:** ‚úÖ –í–∫–ª—é—á–µ–Ω (–∑–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞)

**–ï—Å–ª–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –Ω–µ—Ç:**
- –ù–∞–∂–º–∏—Ç–µ **+ Add Trigger**
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã?

1. –í —Å–ø–∏—Å–∫–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–æ–Ω–∫—É **"Last run"**
2. –ï—Å–ª–∏ —Ç–∞–º –æ—à–∏–±–∫–∞ üî¥ - –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ—ë
3. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
   - **Review Permissions** ‚Üí **Allow**

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

1. –í Google Apps Script: **View ‚Üí Logs**
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –≤ Google Sheet –≤—Ä—É—á–Ω—É—é:
   - –ö–æ–ª–æ–Ω–∫–∞ A: –î–∞—Ç–∞/–≤—Ä–µ–º—è
   - –ö–æ–ª–æ–Ω–∫–∞ B: –ò–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢–µ—Å—Ç –¢—Ä–∏–≥–≥–µ—Ä–∞")
   - –ö–æ–ª–æ–Ω–∫–∞ C: –¢–µ–ª–µ—Ñ–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, "+1(718) 478-4200")
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø–∏—Å–∏:
   ```
   [START] === onSheetEdit triggered ===
   Edit detected: Row X, Column Y...
   ‚úÖ Valid lead data found...
   ‚úÖ Email sent successfully...
   ```

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä

–Ø –æ–±–Ω–æ–≤–∏–ª –∫–æ–¥ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –≤ —Ñ–∞–π–ª–µ `GOOGLE_APPS_SCRIPT_CODE.js`. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è:

1. ‚úÖ **–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤–∏–¥–Ω–æ –∫–∞–∂–¥—ã–π —à–∞–≥
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ Sheet ID** - —Ç—Ä–∏–≥–≥–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –Ω—É–∂–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
3. ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. ‚úÖ **–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∞–Ω—ã
5. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

### –®–ê–ì 1: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª **GOOGLE_APPS_SCRIPT_CODE.js**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–ï–°–¨ –∫–æ–¥ (Ctrl+A, Ctrl+C)
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ Google Apps Script (—É–¥–∞–ª–∏–≤ —Å—Ç–∞—Ä—ã–π)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ (Ctrl+S)

### –®–ê–ì 2: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

1. –í Google Apps Script: ‚è∞ **Triggers**
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç–∞—Ä—ã–π —Ç—Ä–∏–≥–≥–µ—Ä `onSheetEdit` (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –ù–∞–∂–º–∏—Ç–µ **Delete** (—É–¥–∞–ª–∏—Ç—å)
4. –ù–∞–∂–º–∏—Ç–µ **+ Add Trigger**
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Function:** `onSheetEdit`
   - **Event source:** `From spreadsheet`
   - **Event type:** `On edit`
   - **Failure notification settings:** `Immediate`
6. –ù–∞–∂–º–∏—Ç–µ **Save**
7. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç)

### –®–ê–ì 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheet
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É:
   - A: `=NOW()` –∏–ª–∏ —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è
   - B: `–¢–µ—Å—Ç –¢—Ä–∏–≥–≥–µ—Ä–∞`
   - C: `+1(718) 478-4200`
   - D: `test@example.com` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –ù–∞–∂–º–∏—Ç–µ Enter
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - **–õ–æ–≥–∏ –≤ Google Apps Script** (View ‚Üí Logs)
   - **–ü–æ—á—Ç—É ktv@kaykovmedia.com** - –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ email

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –¢—Ä–∏–≥–≥–µ—Ä –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–æ–±—â–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–∏–≥–≥–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –≤–∫–ª—é—á–µ–Ω
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –¢—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –Ω–æ email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `sendEmailForNewLead` –∏–ª–∏ –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - —Ç–∞–º –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ `testEmail()` –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –î–≤–æ–π–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email

**–ü—Ä–∏—á–∏–Ω–∞:** Email –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∏ –∏–∑ `doPost`, –∏ –∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É
- –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–µ–π, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É (–Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –¢—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç–∞—Ä—ã–µ —Å—Ç—Ä–æ–∫–∏

**–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ª—é–±–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–≤—ã—Ö 3 –∫–æ–ª–æ–Ω–æ–∫

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞:
- ‚úÖ –¢—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç–ª–∞–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã



